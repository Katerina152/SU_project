{
  "experiment_name": "isic_tiny_vit_classification_256",
  "output_dir": "runs_classification",

  "task": "single_label_classification",

  "data": {
    "domain": "dermatology",
    "dataset_name": "ISIC2017",
    "resolution": 256,
    "batch_size": 32,
    "num_workers": 4,
    "balanced_train": false,
    "val_split": 0.1
  },

  "model": {
    "type": "vit",
    "backbone": {
      "type": "timm",
      "model_name": "tiny_vit_21m_224.in1k",
      "pooling": "cls",
      "num_layers_to_use": null,
      "pretrained_ckpt":"/home/users/ksa828/cool_project/runs_distillation/ISIC2017/isic_distillation_vit_256/seed_42/job_13339101/checkpoints/best.ckpt",
      "freeze_backbone": true,
      "img_size": 256
    },
    "head": {
      "type": "linear",
      "output_dim": 3,
      "output_activation": null,
      "dropout": 0.0
    },
    "loss_type": "ce"
  },

  "train": {
    "lr": 1e-3,
    "weight_decay": 0,
    "max_epochs": 100,
    "early_stopping_patience": 30,
    "top_k": 1,
    "seed": 42, 
    "profile_flops": true,
    "flops_batch": 10
  },

  "tune": {
    "enabled": false,
    "metric": "val_loss",
    "mode": "min",
    "grid": {
      "train.lr": [1e-4, 3e-4, 1e-3],
      "train.weight_decay": [0.0, 1e-4, 1e-3],
      "data.batch_size": [32, 64]
    }
  }

}

