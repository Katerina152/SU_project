JOB ID: 11772413
Running on host: sh02-13n13.int
HF_HOME=/scratch/users/ksa828/hf_cache
DATA_ROOT=/scratch/users/ksa828/data
GPUs allocated:
Sat Dec 13 15:01:18 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.163.01             Driver Version: 550.163.01     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-16GB           On  |   00000000:07:00.0 Off |                    0 |
| N/A   37C    P0             40W /  300W |       1MiB /  16384MiB |      0%   E. Process |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
HF default cache path: /scratch/users/ksa828/hf_cache/hub
HF_HOME: /scratch/users/ksa828/hf_cache
TRANSFORMERS_CACHE: /scratch/users/ksa828/hf_cache
Parsed arguments: Namespace(function='extract_embeddings', config='scripts/config_extract_embeddings.json')
Loaded 2000 entries from '/scratch/users/ksa828/data/ISIC2017/train/labels.csv'.
Detected 2 classes: ['melanoma', 'seborrheic_keratosis']
Found 26614 images under '/scratch/users/ksa828/data/ISIC2017/train/images' with extension '.jpg'.
final dataset size after filtering missing images: 2000.
[create_image_data_loaders] Loaded train_ds with 2000 samples.
Loaded 150 entries from '/scratch/users/ksa828/data/ISIC2017/val/labels.csv'.
Detected 2 classes: ['melanoma', 'seborrheic_keratosis']
Found 150 images under '/scratch/users/ksa828/data/ISIC2017/val/images' with extension '.jpg'.
final dataset size after filtering missing images: 150.
Loaded 600 entries from '/scratch/users/ksa828/data/ISIC2017/test/labels.csv'.
Detected 2 classes: ['melanoma', 'seborrheic_keratosis']
Found 8838 images under '/scratch/users/ksa828/data/ISIC2017/test/images' with extension '.jpg'.
final dataset size after filtering missing images: 600.
Predicting: |          | 0/? [00:00<?, ?it/s]Predicting: |          | 0/? [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/63 [00:00<?, ?it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   2%|▏         | 1/63 [00:01<01:50,  0.56it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   3%|▎         | 2/63 [00:04<02:08,  0.48it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   5%|▍         | 3/63 [00:04<01:34,  0.63it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   6%|▋         | 4/63 [00:05<01:15,  0.78it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   8%|▊         | 5/63 [00:13<02:35,  0.37it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  10%|▉         | 6/63 [00:14<02:16,  0.42it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  11%|█         | 7/63 [00:14<01:59,  0.47it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  13%|█▎        | 8/63 [00:16<01:52,  0.49it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  14%|█▍        | 9/63 [00:19<01:59,  0.45it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  16%|█▌        | 10/63 [00:22<01:56,  0.45it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  17%|█▋        | 11/63 [00:27<02:08,  0.41it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  19%|█▉        | 12/63 [00:28<02:01,  0.42it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  21%|██        | 13/63 [00:31<02:00,  0.41it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  22%|██▏       | 14/63 [00:31<01:51,  0.44it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  24%|██▍       | 15/63 [00:38<02:01,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  25%|██▌       | 16/63 [00:38<01:53,  0.42it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  27%|██▋       | 17/63 [00:40<01:50,  0.42it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  29%|██▊       | 18/63 [00:41<01:43,  0.43it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  30%|███       | 19/63 [00:48<01:52,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  32%|███▏      | 20/63 [00:48<01:44,  0.41it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  33%|███▎      | 21/63 [00:53<01:46,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  35%|███▍      | 22/63 [00:53<01:40,  0.41it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  37%|███▋      | 23/63 [01:00<01:45,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  38%|███▊      | 24/63 [01:01<01:39,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  40%|███▉      | 25/63 [01:02<01:35,  0.40it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  41%|████▏     | 26/63 [01:05<01:33,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  43%|████▎     | 27/63 [01:10<01:34,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  44%|████▍     | 28/63 [01:11<01:29,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  46%|████▌     | 29/63 [01:12<01:24,  0.40it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  48%|████▊     | 30/63 [01:17<01:25,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  49%|████▉     | 31/63 [01:22<01:25,  0.37it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  51%|█████     | 32/63 [01:23<01:20,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  52%|█████▏    | 33/63 [01:23<01:16,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  54%|█████▍    | 34/63 [01:27<01:14,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  56%|█████▌    | 35/63 [01:29<01:11,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  57%|█████▋    | 36/63 [01:31<01:08,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  59%|█████▊    | 37/63 [01:31<01:04,  0.40it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  60%|██████    | 38/63 [01:39<01:05,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  62%|██████▏   | 39/63 [01:39<01:01,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  63%|██████▎   | 40/63 [01:44<00:59,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  65%|██████▌   | 41/63 [01:44<00:56,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  67%|██████▋   | 42/63 [01:51<00:55,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  68%|██████▊   | 43/63 [01:52<00:52,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  70%|██████▉   | 44/63 [01:56<00:50,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  71%|███████▏  | 45/63 [01:56<00:46,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  73%|███████▎  | 46/63 [02:01<00:44,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  75%|███████▍  | 47/63 [02:01<00:41,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  76%|███████▌  | 48/63 [02:07<00:39,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  78%|███████▊  | 49/63 [02:08<00:36,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  79%|███████▉  | 50/63 [02:10<00:33,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  81%|████████  | 51/63 [02:10<00:30,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  83%|████████▎ | 52/63 [02:17<00:29,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  84%|████████▍ | 53/63 [02:18<00:26,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  86%|████████▌ | 54/63 [02:19<00:23,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  87%|████████▋ | 55/63 [02:21<00:20,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  89%|████████▉ | 56/63 [02:28<00:18,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  90%|█████████ | 57/63 [02:29<00:15,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  92%|█████████▏| 58/63 [02:29<00:12,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  94%|█████████▎| 59/63 [02:30<00:10,  0.39it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  95%|█████████▌| 60/63 [02:38<00:07,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  97%|█████████▋| 61/63 [02:38<00:05,  0.38it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  98%|█████████▊| 62/63 [02:38<00:02,  0.39it/s]pixel_values: torch.Size([16, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0: 100%|██████████| 63/63 [02:38<00:00,  0.40it/s]Predicting DataLoader 0: 100%|██████████| 63/63 [02:38<00:00,  0.40it/s]
Predicting: |          | 0/? [00:00<?, ?it/s]Predicting: |          | 0/? [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/5 [00:00<?, ?it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  20%|██        | 1/5 [00:00<00:02,  1.87it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  40%|████      | 2/5 [00:02<00:04,  0.72it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  60%|██████    | 3/5 [00:04<00:03,  0.65it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  80%|████████  | 4/5 [00:05<00:01,  0.74it/s]pixel_values: torch.Size([22, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0: 100%|██████████| 5/5 [00:17<00:00,  0.29it/s]Predicting DataLoader 0: 100%|██████████| 5/5 [00:17<00:00,  0.29it/s]
Predicting: |          | 0/? [00:00<?, ?it/s]Predicting: |          | 0/? [00:00<?, ?it/s]Predicting DataLoader 0:   0%|          | 0/19 [00:00<?, ?it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:   5%|▌         | 1/19 [00:00<00:10,  1.73it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  11%|█         | 2/19 [00:01<00:10,  1.70it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  16%|█▌        | 3/19 [00:01<00:09,  1.75it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  21%|██        | 4/19 [00:04<00:17,  0.85it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  26%|██▋       | 5/19 [00:15<00:44,  0.31it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  32%|███▏      | 6/19 [00:18<00:39,  0.33it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  37%|███▋      | 7/19 [00:18<00:32,  0.37it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  42%|████▏     | 8/19 [00:48<01:06,  0.17it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  47%|████▋     | 9/19 [01:01<01:08,  0.15it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  53%|█████▎    | 10/19 [01:04<00:58,  0.15it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  58%|█████▊    | 11/19 [01:05<00:47,  0.17it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  63%|██████▎   | 12/19 [01:32<00:53,  0.13it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  68%|██████▊   | 13/19 [01:45<00:48,  0.12it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  74%|███████▎  | 14/19 [01:47<00:38,  0.13it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  79%|███████▉  | 15/19 [01:47<00:28,  0.14it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  84%|████████▍ | 16/19 [01:47<00:20,  0.15it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  89%|████████▉ | 17/19 [01:52<00:13,  0.15it/s]pixel_values: torch.Size([32, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0:  95%|█████████▍| 18/19 [01:55<00:06,  0.16it/s]pixel_values: torch.Size([24, 3, 512, 512])
hf expected: 512
Predicting DataLoader 0: 100%|██████████| 19/19 [01:55<00:00,  0.16it/s]Predicting DataLoader 0: 100%|██████████| 19/19 [01:55<00:00,  0.16it/s]
Done.
